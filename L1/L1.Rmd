---
title: 'Lecture 1: R tips, tricks & tools'
author: "<br> <br >Yanfei Kang <br> yanfeikang@buaa.edu.cn"
date: "School of Economics and Management <br> Beihang University"
output:
  slidy_presentation:
    footer: "Lecture 1: R Basics (Mar 6, 2017)"
    css: ../styles/ykstyle.css
logo: buaalogo.png
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Getting and Installing R

- Totally free!
- Download R on its [official website](https://www.r-project.org).



# R User Interface

- Direct **R**
- Rstudio
    - One of the most popular ways to run R.
    - Free, open-source integrated development environment (IDE) for R.
    - Many additional fantastic features.
- Command line in Linux and Unix.



# Editor

- Use a good text editor
- e.g. vim, sublime text, text wrangler, notepad, etc
- With syntax highlighting, otherwise, it's hard to detect errors
- Or use an Integrated Development Environment (IDE) like RStudio

# Use an IDE

- Syntax highlighting
- Syntax aware
- Able to evaluate R code
      + by line
      + by selection 
      + entire file
- Command auto-completion




# Choose the names of variables carefully

Choose a consistent naming style for objects and functions

- someObject (lowerCamelCase)
- SomeObject (UpperCamelCase)
- some_object (underscore separation)
- some.object (dot separation)

Avoid using names of standard R objects

- mean
- var
- median



# Indenting 

- Keep your indentation style consistent
- There is more than one way of indenting code
- There is no ‚Äúbest‚Äù style that everyone should be following
- You can indent using spaces or tabs (but don‚Äôt mix them)
- Can help in detecting errors in your code because it can expose lack of symmetry
- Do this systematically (RStudio editor helps a lot)
- Reindenting and reformatting using RStudio.
- formatR package: I run `tidy.dir()` before reading student code!

```{r}
# Do not do this!
find_roots <- function(a = 1, b = 1, c = 0) {
if (b^2 - 4*a*c < 0) {
return("No real roots") } else
{
return(quadratic(a = a, b = b, c = c)) }
}
```

$\Rightarrow$

```{r}
# Better with indentation
find_roots <- function(a = 1, b = 1, c = 0) {
  if (b^2 - 4*a*c < 0) {
    return("No real roots")
  } else
  {
    return(quadratic(a = a, b = b, c = c))
  }
}
```









# White Spaces
- Use a lot of it
- around operators (assignment and arithmetic)
- between function arguments and list elements
- between matrix/array indices, in particular for missing indices
- Split long lines at meaningful places



Avoid this

```
a<-2
x<-3
y<-log(sqrt(x))
3*x^7-pi*x/(y-a)
plot(x,y,col=rgb(0.5,0.7,0.4),pch='+',cex=5)
```
Much Better

```
a <- 2
x <- 3
y <- log(sqrt(x))
3*x^7 - pi * x / (y - a)
plot(x, y, col = rgb(0.5, 0.7, 0.4), pch = '+', cex = 5)
```

Don‚Äôt be afraid of splitting one long line into individual pieces!

```
n = matrix(sample(1:100, 9), nrow = 3, ncol = 3, byrow = TRUE)
```

$\Rightarrow$

```{}
n = matrix(sample(1:100, 9),
           nrow = 3,
           ncol = 3,
           byrow = TRUE)
```

# Header, Line spaces and Comments

- Add a Header for your file
- Add lots of comments
- But don‚Äôt belabor the obvious
- Use blank lines to separate blocks of code and comments to say what the block does
  Remember that in a few months, you may not follow your own code any better than a stranger
- Some key things to document: ‚Äì summarizing a block of code
- explaining a very complicated piece of code ‚Äì explaining arbitrary constant values



```{r}
x <- c(1:10)
x.mean = mean(x)
x.var = var(x)
```

$\Rightarrow$

```{r}
# =============================================
# Title
# Author: Yanfei Kang
# Date: Mar 23, 2017
# Description: your purpose
# =============================================

x <- c(1:10)

# getting the mean of x
x.mean = mean(x)

# getting the variance of x
x.var = var(x)
```



# Organize your R projects

Basic idea

- Every paper, book or consulting report is a `project'.
- Every project has its own folder and R workspace.
- Every project is entirely scripted. That is, all analysis, graphs and tables must be able to be generated by running one R script. 
    + `main.R` sources all other R files in the correct order.
    + `functions.R` contains all non-packaged functions used in the project.
    + each function can not be too long.
    
  

# How to find the right function 

- Functions in installed packages
  `help.search("neural")` or `??neural`
- Functions in other CRAN packages
 
```
library(sos)
findFn("neural")
RSitesearch("neural")
```
 
# Digging into functions

- Typing the name of a function gives its definition.
- Type `package:::function` for hidden functions.
- Download the tar.gz file from CRAN if you want to see any underlying **C** or **Fortran** code.




# Other suggestions
## Look at other people's codes 
- https://github.com/hadley
- https://github.com/yihui
- https://github.com/karthik
- https://github.com/kbroman
- https://github.com/cboettig
- https://github.com/garrettgman

## Getting help
- For programming questions: StackOverflow.com
- For statistical questions: CrossValidated.com

## Keep up-to-date
- RStudio blog: blog.rstudio.org
- R-bloggers: www.r-bloggers.com
It takes time to develop your own style. Once it is developed, it is really hard to be changed. So please be careful at the beginning. 
    
# Your turn üíì

- Write a function named `quaroot()` to solve the roots of given quadratic equation $ax^2 + bx + c = 0$ with $a$, $b$ and $c$ as input arguments. 

- Test your function on some simple equations.

- Keep in mind the tips we have learnt.



# Suggested reading

- [Google R style guide](https://google-styleguide.googlecode.com/svn/ trunk/Rguide.xml).
- [Hadley's style](http://adv-r.had.co.nz/Style.html)
